{"ast":null,"code":"import { withIronSession } from \"next-iron-session\";\nimport data from \"../../data\";\nexport default withIronSession(async (req, res) => {\n  if (req.method === \"POST\") {\n    const users = await data.readTable(\"Users\");\n    const {\n      email,\n      password\n    } = req.body;\n\n    for (let i = 0; i < users.length; i++) {\n      if (users[i].email === email && users[i].passHash === password) {\n        req.session.set(\"user\", {\n          email\n        });\n        await req.session.save();\n        return res.status(201).send(\"\");\n      }\n    }\n\n    return res.status(403).send(\"\");\n  }\n\n  return res.status(404).send(\"\");\n}, {\n  cookieName: \"MYSITECOOKIE\",\n  cookieOptions: {\n    secure: false ? true : false\n  },\n  password: process.env.APPLICATION_SECRET\n});","map":{"version":3,"sources":["/home/charles/serverless-next.js/packages/serverless-components/nextjs-component/examples/evote/pages/api/sessions.js"],"names":["withIronSession","data","req","res","method","users","readTable","email","password","body","i","length","passHash","session","set","save","status","send","cookieName","cookieOptions","secure","process","env","APPLICATION_SECRET"],"mappings":"AAAA,SAASA,eAAT,QAAgC,mBAAhC;AACA,OAAOC,IAAP,MAAiB,YAAjB;AAEA,eAAeD,eAAe,CAC5B,OAAOE,GAAP,EAAYC,GAAZ,KAAoB;AAClB,MAAID,GAAG,CAACE,MAAJ,KAAe,MAAnB,EAA2B;AACzB,UAAMC,KAAK,GAAG,MAAMJ,IAAI,CAACK,SAAL,CAAe,OAAf,CAApB;AACA,UAAM;AAAEC,MAAAA,KAAF;AAASC,MAAAA;AAAT,QAAsBN,GAAG,CAACO,IAAhC;;AAEA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,KAAK,CAACM,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACrC,UAAIL,KAAK,CAACK,CAAD,CAAL,CAASH,KAAT,KAAmBA,KAAnB,IAA4BF,KAAK,CAACK,CAAD,CAAL,CAASE,QAAT,KAAsBJ,QAAtD,EAAgE;AAC9DN,QAAAA,GAAG,CAACW,OAAJ,CAAYC,GAAZ,CAAgB,MAAhB,EAAwB;AAAEP,UAAAA;AAAF,SAAxB;AACA,cAAML,GAAG,CAACW,OAAJ,CAAYE,IAAZ,EAAN;AACA,eAAOZ,GAAG,CAACa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAArB,CAAP;AACD;AACF;;AAED,WAAOd,GAAG,CAACa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAArB,CAAP;AACD;;AACD,SAAOd,GAAG,CAACa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAArB,CAAP;AACD,CAjB2B,EAkB5B;AACEC,EAAAA,UAAU,EAAE,cADd;AAEEC,EAAAA,aAAa,EAAE;AACbC,IAAAA,MAAM,EAAE,QAAwC,IAAxC,GAA+C;AAD1C,GAFjB;AAKEZ,EAAAA,QAAQ,EAAEa,OAAO,CAACC,GAAR,CAAYC;AALxB,CAlB4B,CAA9B","sourcesContent":["import { withIronSession } from \"next-iron-session\";\nimport data from \"../../data\";\n\nexport default withIronSession(\n  async (req, res) => {\n    if (req.method === \"POST\") {\n      const users = await data.readTable(\"Users\")\n      const { email, password } = req.body;\n\n      for (let i = 0; i < users.length; i++) {\n        if (users[i].email === email && users[i].passHash === password) {\n          req.session.set(\"user\", { email });\n          await req.session.save();\n          return res.status(201).send(\"\");\n        }\n      }\n\n      return res.status(403).send(\"\");\n    }\n    return res.status(404).send(\"\");\n  },\n  {\n    cookieName: \"MYSITECOOKIE\",\n    cookieOptions: {\n      secure: process.env.NODE_ENV === \"production\" ? true : false\n    },\n    password: process.env.APPLICATION_SECRET\n  }\n);\n"]},"metadata":{},"sourceType":"module"}