{"ast":null,"code":"import { withIronSession } from \"next-iron-session\";\nimport data from \"../../data\";\n\nconst bcrypt = require('bcryptjs');\n\nexport default withIronSession(async (req, res) => {\n  if (req.method === \"POST\") {\n    const users = await data.readTable(\"Users\");\n    const {\n      email,\n      password\n    } = req.body;\n\n    for (let i = 0; i < users.length; i++) {\n      if (users[i].email === email) {\n        var match = bcrypt.compareSync(password, users[i].passHash);\n\n        if (match) {\n          const fName = users[i].fName;\n          req.session.set(\"user\", {\n            email,\n            fName\n          });\n          await req.session.save();\n          return res.status(201).send(\"\");\n        } else {\n          return res.status(403).send(\"\");\n        }\n      }\n    }\n\n    return res.status(403).send(\"\");\n  }\n\n  return res.status(404).send(\"\");\n}, {\n  cookieName: \"LOGIN\",\n  cookieOptions: {\n    secure: true ? true : false\n  },\n  password: process.env.APPLICATION_SECRET\n});","map":null,"metadata":{},"sourceType":"module"}